
<html><head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta content="text/javascript" http-equiv="content-script-type">
<title>dmake</title>
<link rel="stylesheet" type="text/css" href="candydoc/style.css">
<!--[if lt IE 7]><link rel="stylesheet" type="text/css" href="candydoc/ie56hack.css"><![endif]-->
<script language="JavaScript" src="candydoc/util.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/tree.js" type="text/javascript"></script>
<script language="JavaScript" src="candydoc/explorer.js" type="text/javascript"></script>
</head><body>
<div id="tabarea"></div><div id="explorerclient"></div>
<div id="content"><script>explorer.initialize("dmake");</script>
	<table class="content">
		<tr><td id="docbody"><h1>dmake</h1><!-- Generated by Ddoc from dmake.d -->
<b>Version:</b><br>
1.0
<br><br>
<b>License:</b><br>
LGPL 3
<br><br>

	This module simplifies crossplatform compilation for multifile projects. Module provides
	functions to control dependencies written in no D languages and can check existance
	of needed instruments and libraries in system. Supported compile targets: applications,
	static libraries (.a .lib), shared libraries (.so .dll).

<br><br>
<font color=red>BUGS:</font><br>
linux shared libraries generation at x86_64 seemed to be broken; static dll linkage broken

<br><br>
<b>Example:</b><br>
<pre class="d_code">	<font color=blue>import</font> <u>dmake</u>;

	<font color=green>// main application out dependencies
</font>	string[string] appDepends;

	<font color=green>// set up appDepends
</font>	<font color=blue>static</font> <font color=blue>this</font>()
	{
		appDepends = [
			<font color=red>"outLib1"</font> : <font color=red>"../deps/outLib1"</font>
		];
	}

	<font color=green>// Function to compile outlib if necessary
</font>	<font color=blue>void</font> compileOutLib1(string path)
	{
		<font color=blue>version</font>(Windows)
		{
			<font color=green>// some shell calls ...
</font>		}
		<font color=blue>version</font>(linux)
		{
			<font color=green>// you can check instrument existance
</font>			checkProgram(<font color=red>"make"</font>, <font color=red>"Cannot find make, you can get it from your standart source repository!"</font>);
			<font color=green>// some shell calls ...
</font>		}
	}

	<font color=blue>int</font> main(string[] args)
	{
		<font color=green>// your library
</font>		addCompTarget(<font color=red>"mylib"</font>, <font color=red>"../lib"</font>, <font color=red>"mylib"</font>, BUILD.LIB);
		addSource(<font color=red>"../src/mylib"</font>);

		<font color=green>// Adding main application
</font>		addCompTarget(<font color=red>"app"</font>, <font color=red>"../bin"</font>, <font color=red>"main"</font>, BUILD.APP);
		addSource(<font color=red>"../src/app"</font>);
		setDependPaths(appDepends);

		<font color=green>// Adding to app dependency outLib1 files
</font>		<font color=green>// Windows: ../deps/outLib1/lib/file1.lib, ../deps/outLib1/lib/file2.lib
</font>		<font color=green>// GNU/Linux: ../deps/outLib1/lib/libfile1.a, ../deps/outLib1/lib/libfile2.a
</font>		<font color=green>// with import search file ../deps/outLib1/import
</font>		<font color=green>// if files cannot be found, delegate compileOutLib1 called.
</font>		addLibraryFiles(<font color=red>"outLib1"</font>, <font color=red>"lib"</font>, [<font color=red>"file1"</font>, <font color=red>"file2"</font>], [<font color=red>"import"</font>] , &amp;compileOutLib1);

		<font color=green>// adding your libary as app dependency
</font>		addDependTarget(<font color=red>"mylib"</font>);

		<font color=green>// Begin actual compilation
</font>		<font color=green>// arguments 'all debug' will compile all targets in debug mode
</font>		<font color=green>// argument  'mylib' will compile only mylib in release mode
</font>		<font color=green>// arguments 'app release' will compile first mylib, then app in release mode
</font>		<font color=blue>return</font> proceedCmd(args);
	}
</pre>
<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">checkProgram</span>
<script>explorer.outline.addDecl('checkProgram');</script>

(string <span class="funcparam">name</span>, string <span class="funcparam">msg</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">checkProgram</span>
<script>explorer.outline.addDecl('checkProgram');</script>


<br><br>
Function helps check program availability through system shell.
	Program  should be typed without extention as if you typed it
	in shell. If function doesn't find program, compilation stops and
	message  displays to the user. Usefull to put into  informathion
	where you can get needed program.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addCompTarget</span>
<script>explorer.outline.addDecl('addCompTarget');</script>

(string <span class="funcparam">name</span>, string <span class="funcparam">outDir</span>, string <span class="funcparam">outName</span>, BUILD <span class="funcparam">type</span> = (BUILD).APP);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">addCompTarget</span>
<script>explorer.outline.addDecl('addCompTarget');</script>


<br><br>
Add compilation target with  and sets to current target. Almost functions operate with
	seted current target. To switch within targets use . String  sets
	output directory where finally binary file with <span class="funcparam">name</span>  will be put. Enum value 
	determines the output <span class="funcparam">type</span>. BUILD.APP - application, BUILD.LIB - static library, BUILD.SHARED -
	shared library (.dll or .so). All library prefixes and file extentions will be appended automatically.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	<font color=green>// Setting up simple application.
</font>	<font color=green>// output file will be named as main.exe (Win) or main (GNU/Linux)
</font>	<u>addCompTarget</u>(<font color=red>"app"</font>, <font color=red>"./bin"</font>, <font color=red>"main"</font>, BUILD.APP);

	<font color=green>// Setting up simple library
</font>	<font color=green>// output file will be named as test.lib (Win) or libtest.a (GNU/Linux)
</font>	<u>addCompTarget</u>(<font color=red>"lib"</font>, <font color=red>"./lib"</font>, <font color=red>"test"</font>, BUILD.LIB);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addDependTarget</span>
<script>explorer.outline.addDecl('addDependTarget');</script>

(string <span class="funcparam">name</span>, bool <span class="funcparam">linkStatic</span> = false);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">addDependTarget</span>
<script>explorer.outline.addDecl('addDependTarget');</script>


<br><br>
This function helps order targets compilation. Current compile target
	will compile after target . If circular dependencies detected,
	compilation will fail with a message. If  is <b>true</b> and
	target  is shared library, import library will be linked to app,
	else does nothing.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	addCompTarget(<font color=red>"library"</font>, <font color=red>"."</font>, <font color=red>"somelib"</font>, BUILD.LIB);
	addCompTarget(<font color=red>"app"</font>, <font color=red>"."</font>, <font color=red>"main"</font>, BUILD.APP);
	<font color=green>//...
</font>	<font color=green>// library
</font>	<font color=blue>return</font> proceedCmd(args);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">setHeadersGeneration</span>
<script>explorer.outline.addDecl('setHeadersGeneration');</script>

(string <span class="funcparam">dir</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">setHeadersGeneration</span>
<script>explorer.outline.addDecl('setHeadersGeneration');</script>


<br><br>
Sets header generation fo current compilation target, also
	known as interface (.di) files. Sets headers output folder to
	<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">setCompilationModel</span>
<script>explorer.outline.addDecl('setCompilationModel');</script>

(MODEL <span class="funcparam">model</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">setCompilationModel</span>
<script>explorer.outline.addDecl('setCompilationModel');</script>


<br><br>
Explicitly sets current target  MODEL.X86_64 or MODEL.X86.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">setDocsGeneration</span>
<script>explorer.outline.addDecl('setDocsGeneration');</script>

(string <span class="funcparam">dir</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">setDocsGeneration</span>
<script>explorer.outline.addDecl('setDocsGeneration');</script>


<br><br>
Sets documentation generation for current compilation target
	and sets output docs <span class="funcparam">dir</span> as .<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">setCurrTarget</span>
<script>explorer.outline.addDecl('setCurrTarget');</script>

(string <span class="funcparam">name</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">setCurrTarget</span>
<script>explorer.outline.addDecl('setCurrTarget');</script>


<br><br>
Sets current compilation target to . All other functions
	will operate with this target. If target wasn't registered, throws
	exception.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">CompilationTarget 
<span class="currsymbol">getCurrentTarget</span>
<script>explorer.outline.addDecl('getCurrentTarget');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">getCurrentTarget</span>
<script>explorer.outline.addDecl('getCurrentTarget');</script>


<br><br>
Returns compilation target assigned to current target.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">setDependPaths</span>
<script>explorer.outline.addDecl('setDependPaths');</script>

(string[string] <span class="funcparam">paths</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">setDependPaths</span>
<script>explorer.outline.addDecl('setDependPaths');</script>


<br><br>
Registeres dependencies passed with string massive  for
	current compilation target.  keys used for dependencies names
	and values used for dependencies relative <span class="funcparam">paths</span>. Needs to be called
	before  or .<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addLibraryFiles</span>
<script>explorer.outline.addDecl('addLibraryFiles');</script>

(T)(string <span class="funcparam">lib</span>, string <span class="funcparam">filesPath</span>, string[] <span class="funcparam">names</span>, string[] <span class="funcparam">importPaths</span>, T <span class="funcparam">compileDelegate</span>, bool <span class="funcparam">tryAgain</span> = true);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Binds library files listed in  without extentions (*.a, *.lib) and prefixes (lib*) to dependency .
	 is relative path from dependency root path where script should find library files. Each entry from
	 will be passed to compiler as search library sources path. If function isn't able to find all listed
	files, it runs delegate  which should try to compile those files, function passes to 
	dependency root path. If boolean value  switched to , function will retry adding library files.
<br><br>
<b>Example:</b><br>
<pre class="d_code">	addCompTarget(<font color=red>"app"</font>, <font color=red>"."</font>, <font color=red>"main"</font>, BUILD.APP);
	setDependPaths([<font color=red>"library"</font>: <font color=red>"../lib"</font>]);

	<u>addLibraryFiles</u>(<font color=red>"library"</font>, <font color=red>"../lib/bin"</font>, [<font color=red>"first"</font>, <font color=red>"second"</font>], [<font color=red>"import"</font>],
		(string libPath)
		{
			<font color=green>// Here some code to compile library
</font>		});
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">checkSharedLibraries</span>
<script>explorer.outline.addDecl('checkSharedLibraries');</script>

(T)(string <span class="funcparam">lib</span>, string[] <span class="funcparam">names</span>, T <span class="funcparam">compileDelegate</span>, bool <span class="funcparam">checkAgain</span> = true, bool <span class="funcparam">findInSystem</span> = false);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">checkSharedLibraries</span>
<script>explorer.outline.addDecl('checkSharedLibraries');</script>


<br><br>
Some dependencies compiled to shared library files (.dll or .so) and they cannot be directly added to compilation target. Function checks
	existence of shared library files listed by  without prefixes (lib) and extentions (.so, .dll) for dependency  added before with
	. If function cannot find  at out directory or system paths, then it calls delegate  with name of root
	dependency dir. Delegate should try to compile dependency and if  flag setted to , function will recheck . If
	 setted to , function will also try find libraries in system paths.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	addCompTarget(<font color=red>"app"</font>, <font color=red>"."</font>, <font color=red>"main"</font>, BUILD.APP);
	setDependPaths([<font color=red>"library"</font>: <font color=red>"../lib"</font>]);

	addLibraryFiles(<font color=red>"library"</font>, [<font color=red>"first"</font>, <font color=red>"second"</font>],
		(string libPath)
		{
			<font color=green>// Here some code to compile library
</font>		});
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addSource</span>
<script>explorer.outline.addDecl('addSource');</script>

(string <span class="funcparam">dir</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">addSource</span>
<script>explorer.outline.addDecl('addSource');</script>


<br><br>
Adding all *.d and *.di files from directory  to current compilation target. All subdirectories and
	links recursively will be passed.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	setCurrTarget(<font color=red>"app"</font>);
	<font color=green>// All files and subdirs will be passed
</font>	<u>addSource</u>(<font color=red>"../src"</font>);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">addSingleFile</span>
<script>explorer.outline.addDecl('addSingleFile');</script>

(string <span class="funcparam">name</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">addSingleFile</span>
<script>explorer.outline.addDecl('addSingleFile');</script>


<br><br>
Occasionally situation occurs when needed add only some files to compilation target and  doesn't suit.
	Then you call this function with exact source , which will be added to current compilation target.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	setCurrTarget(<font color=red>"app"</font>);
	<u>addSingleFile</u>(<font color=red>"./src/main.d"</font>);
	<u>addSingleFile</u>(<font color=red>"../scripts/somemodule.d"</font>);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">compileTarget</span>
<script>explorer.outline.addDecl('compileTarget');</script>

(string <span class="funcparam">target</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">compileTarget</span>
<script>explorer.outline.addDecl('compileTarget');</script>


<br><br>
Sends to compilation <span class="funcparam">target</span> with name . This function doesn't consider compilation dependencies, see
	. If function cannot find <span class="funcparam">target</span>, exception occured.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">int 
<span class="currsymbol">proceedCmd</span>
<script>explorer.outline.addDecl('proceedCmd');</script>

(string[] <span class="funcparam">args</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">proceedCmd</span>
<script>explorer.outline.addDecl('proceedCmd');</script>


<br><br>
Parses cmd input arguments and compile specified target. First argument is target name or special word 'all',
	which compile all targets. Second argument is compile mode: debug or release; it can be not passed, then release
	mode will be used. Function detects tangled arguments, thats why 'debug' and 'release' target names restricted.
	This function needs to be called last and returns standart system return code. Function will detect all input
	errors and show error reasons. Targets compiles in dependency order, if circular dependencies occures compilation
	will be stopped and message will be shown.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	<font color=blue>int</font> main(string[] <i>args</i>)
	{
		<font color=green>// First set up all targets and dependencies
</font>		<font color=green>//...
</font>
		<font color=green>// Here begins actual compilation
</font>		<font color=blue>return</font> <u>proceedCmd</u>(<i>args</i>);
	}
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">bool 
<span class="currsymbol">programExists</span>
<script>explorer.outline.addDecl('programExists');</script>

(string <span class="funcparam">name</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">programExists</span>
<script>explorer.outline.addDecl('programExists');</script>


<br><br>
Checks availability of program  (without extention) through system shell.
	Doesn't support alias names.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	<u>programExists</u>(<font color=red>"make"</font>);
	<u>programExists</u>(<font color=red>"gcc"</font>);

	<font color=green>// Windows standart shell names examples
</font>	<u>programExists</u>(<font color=red>"chkdisk"</font>);
	<u>programExists</u>(<font color=red>"del"</font>);

	<font color=green>// Checks local program
</font>	<u>programExists</u>(<font color=red>"myProg"</font>);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">bool 
<span class="currsymbol">sharedLibraryExists</span>
<script>explorer.outline.addDecl('sharedLibraryExists');</script>

(string <span class="funcparam">name</span>);
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">sharedLibraryExists</span>
<script>explorer.outline.addDecl('sharedLibraryExists');</script>


<br><br>
Checks existance of shared library (.so or .dll) with  (without prefixes and extention)
	in system library search paths.

<br><br>
<b>Example:</b><br>
<pre class="d_code">	<font color=green>// Windows examples
</font>	<u>sharedLibraryExists</u>(<font color=red>"kernel32"</font>);

	<font color=green>// Some linux library
</font>	<u>sharedLibraryExists</u>(<font color=red>"freeimage-3.15.4"</font>);
</pre>
<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">class 
<span class="currsymbol">CompilationTarget</span>
<script>explorer.outline.addDecl('CompilationTarget');</script>

;
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">CompilationTarget</span>
<script>explorer.outline.addDecl('CompilationTarget');</script>


<br><br>
Usually you don't need to work with this class directly. It's temporaly storage of all compilation settings.<br><br>


<script>explorer.outline.incSymbolLevel();</script>
<dl>
<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">void 
<span class="currsymbol">convertWinNames</span>
<script>explorer.outline.addDecl('convertWinNames');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>
<span class="currsymbol">convertWinNames</span>
<script>explorer.outline.addDecl('convertWinNames');</script>


<br><br>
Replaces primary slashes with backslashes in all important fields.<br><br>

</dd>

<script>explorer.outline.writeEnabled = true;</script>
<dt><span class="decl">@property string 
<span class="currsymbol">finalname</span>
<script>explorer.outline.addDecl('finalname');</script>

();
</span></dt>
<script>explorer.outline.writeEnabled = false;</script>


<dd>Returns final relative out file name with extentions and prefixes.<br><br>

</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</dd>
</dl>
<script>explorer.outline.decSymbolLevel();</script>


</td></tr>
		<tr><td id="docfooter">
			Page was generated with
			<img src="candydoc/img/candydoc.gif" style="vertical-align:middle; position:relative; top:-1px">
			on Fri Aug 10 00:53:57 2012

		</td></tr>
	</table>
</div>
<script>
	explorer.packageExplorer.addModule("dmake");</script>
</body></html>


